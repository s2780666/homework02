---
title: "hw-02"
author: "Your Name (S2780666)"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
## **DO NOT EDIT THIS CODE CHUNK**
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

```{r}
strava_runs <- read_csv("data/strava_runs.csv")
```

```{r}
data_5k_10k <- strava_runs %>%
  mutate(
    event = case_when(
      distance..m. > 4998 & distance..m. < 5015  ~ "5k",
      distance..m. > 9998 & distance..m. < 10015 ~ "10k",
      TRUE ~ NA_character_
    )
  ) %>%
  filter(!is.na(event))
```


## Exercise 1

```{r ex1a, out.width="80%"}
data_5k_10k %>% 
  filter(gender == "M") %>%
  filter(!is.na(average.heart.rate..bpm.)) %>%
  ggplot(aes(x = average.heart.rate..bpm.)) + 
  geom_histogram(bins = 20)

male_summary <- data_5k_10k %>%
  filter(gender == "M") %>%
  filter(!is.na(average.heart.rate..bpm.)) %>%
  summarise(
    Mean = mean(average.heart.rate..bpm.),
    Median = median(average.heart.rate..bpm.),
    SD = sd(average.heart.rate..bpm.),
    Min = min(average.heart.rate..bpm.),
    Max = max(average.heart.rate..bpm.),
    Length = length(average.heart.rate..bpm.)
  )
male_summary
```

(a)
The histogram for male runners’ average heart rate shows a roughly unimodal and slightly right-skewed distribution, with most runners’ heart rates concentrated between 140–165 bpm.
The calculated summary statistics show: Mean ≈ 147.9444 bpm, Median ≈ 147.9 bpm, SD ≈ 17.2218 bpm,length =252
This suggests that most male runners maintain a moderate heart rate, with a few outliers who exhibit higher heart rates.


```{r ex1b, out.width="80%"}
# Write your code for Ex1b here

data_5k_10k %>% 
  filter(gender == "F") %>%
  filter(!is.na(average.heart.rate..bpm.)) %>%
  ggplot(aes(x = average.heart.rate..bpm.)) + 
  geom_histogram(bins = 20)

female_summary <- data_5k_10k %>%
  filter(gender == "F") %>%
  filter(!is.na(average.heart.rate..bpm.)) %>%
  summarise(
    Mean = mean(average.heart.rate..bpm.),
    Median = median(average.heart.rate..bpm.),
    SD = sd(average.heart.rate..bpm.),
    Min = min(average.heart.rate..bpm.),
    Max = max(average.heart.rate..bpm.),
    Length = length(average.heart.rate..bpm.)
  )
female_summary




```


(b)
The histogram for female runners'average heart rate shows bimodal distribution, which focus around 150–170 bpm.
The summary statistics indicate:Mean ≈ 155.6829 bpm， Median ≈ 156.7 bpm， SD ≈ 13.2207 bpm， length=76
Comparing with male runners, female runners generally show higher average heart rates. In addition, female runners have a smaller standard deviation than male runners, which indicated that their average heart rates are more consistent.However,the smaller SD among female runners could be related to the their smaller length, which could make the distribution appear more consistent.

## Exercise 2

```{r ex2, out.width = "80%"}
# Write your code to answer exercise 2a here

data_5k_10k <- data_5k_10k %>%
  filter(!is.na(gender)) %>%
  mutate(
    pace = (elapsed.time..s. / 60) / (distance..m. / 1000)
  )


ggplot(data = data_5k_10k,
       mapping = aes(x = event, y = pace, fill= event)) +
   
  geom_boxplot(coef = 1,
               fill = "grey",
               colour = "black",
               lwd = 0.5,         
               outlier.shape = 4,
               outlier.color = "red") +
  facet_wrap(~gender) +
  labs(
    title = "Pace Comparison between 5K and 10K Runs ",
    subtitle = "By Gender",
    x = "Event Type",
    y = "Pace (minutes per km)",
  ) +
  theme_bw() 

```


The boxplots clearly show that  runners of both genders generally have faster speed(lower minutes per km)in 5k events than in 10k events. In addition, compared with female runners, male runners tend to be faster and more consistent in both events .
Comparing the two events, the 5k event obviously has more outliers in both genders, which shows that runners' performance in the 5k event is not stable.


## Exercise 3

```{r ex3, out.width = "80%"}
# Write your code to answer exercise 3 here

strava_runs <- read_csv("strava_runs.csv")

avg_distance <- strava_runs %>%
  group_by(athlete) %>%
  summarise(Mean = mean(distance..m., na.rm = TRUE))

runner_class <- avg_distance %>%
  mutate(
    runner_type = case_when(
      Mean > 13000 ~ "Long-distance",
      Mean < 7000  ~ "Short-distance",
      TRUE ~ NA_character_
    )
  ) %>%
  filter(!is.na(runner_type))

classified_runs <- strava_runs %>%
  inner_join(runner_class, by = "athlete") %>%
  mutate(
    distance_km = distance..m. / 1000,
    avg_mps = distance..m. / elapsed.time..s.
  )

ggplot(classified_runs, aes(x = distance_km, y = avg_mps, color = runner_type)) +
  geom_point(alpha=0.25) +
  geom_smooth(method = lm) +
  scale_color_manual(values = c("Short-distance" = "forestgreen", "Long-distance" = "orange")) +
  labs(
    title = "Speed vs Distance for Long- and Short-Distance Runners",
    subtitle = "Grouped by runners' average distance (>13 km vs <7 km)",
    x = "Run distance (km)",
    y = "Average Speed (m/s)",
    color = "Runner Type"
  ) +
   theme_bw()


```





## Exercise 4

#### Example of a good data visualisation

```{r ex4_good_viz, echo = FALSE, out.width = "80%"}
# edit the file path accordingly
knitr::include_graphics("img/good_viz.png")
```


**Our World in Data**, "**Deaths in armed conflicts by region**" [Online]. Available at: **https://ourworldindata.org/grapher/deaths-in-armed-conflicts-by-region?time=1989..2025** (Accessed: **29 October 2025**)


The above image presents a good data visualisation because:

-   _Reason 1_
    Respect the data
   The visualisation lets the data speak for itself without manipulation for a particular narrative.
    The bar chart is very suitable to represent deaths in different regions over time. It has used an informative title and axis labels. The subtitle also clearly shows the detailed information about visualisation.
    
-   _Reason 2_
   Respect the people
   The design of the visualisation is clean and accessible. Colours on it are distinct and labelled, the legend is easy to read, and the chart layout supports viewers’ cognitive understanding. It also communicates complex information more easily.


#### Example of a bad data visualisation


```{r ex4_bad_viz, echo = FALSE, out.width = "80%"}
# edit the file path accordingly
knitr::include_graphics("img/bad_viz.png")
```


**Aditya Raj**, "**12 Bad Data Visualization Examples Explained**" [Online]. Available at: **https://i0.wp.com/www.codeconquest.com/wp-content/uploads/image-11.png?w=1079&ssl=1** (Accessed: **29 October 2025**)



The above image presents a bad data visualisation because:

-   _Reason 1_
   Not respect the mathematics
   The Y-axis of this visualisation scale is distorted, which suddenly jumps from $700M to $1,700M. This breaking the proportional relationship between bar lengths and actual values. The revenue of $490M looks bigger than $1213M of government funding, which seriously misleads the viewer.
-   _Reason 2_
   not respect the data and the people
   The chart design is confusing because the categories are not shown clearly or consistently. The “Revenue” and the “advertising revenue” are drawn as separate bars, even though they are part of the same total. This makes it difficult for audiences to understand the real relationship between them.
Additionally, the visualisation style is not appropriate enough. Instead of using multiple separate bar charts, combining some extra charts into one or two charts will be better. Besides, adding some appropriate and accurate text can help people understand the visualisation better.


